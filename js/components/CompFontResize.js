/*
=====================================
CompFontResize
js/components/CompFontResize.js

üê≠ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ —à—Ä–∏—Ñ—Ç–∞

–°—É—Ç—Ä—ã:
‚Äì –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ HTML –∫–∞–∫ <comp-font-resize></comp-font-resize>
‚Äì –°–∞–º —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ customElements.define
‚Äì –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ HTML –∏–ª–∏ JS
‚Äì –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å DOM (–±–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è)

–ü–æ–≤–µ–¥–µ–Ω–∏–µ:
‚Äì –ú–µ–Ω—è–µ—Ç font-size —É —Ü–µ–ª–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: main, .title)
‚Äì –≠–ª–µ–º–µ–Ω—Ç—ã —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º data-no-resize –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
‚Äì –ù–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç–∏–ª—è–º–∏ –Ω–∞–ø—Ä—è–º—É—é (CSS –∂–∏–≤—ë—Ç –æ—Ç–¥–µ–ª—å–Ω–æ)
‚Äì –ù–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞–º–∏

===================================== */

const shortWords = [
  '–∏', '–≤', '–≤–æ', '–Ω–µ', '–Ω–∞', '–Ω–æ', '–∞', '—Å', '—Å–æ', '–∫', '–∫–æ', '–æ—Ç', '–∑–∞', '—É', '–æ', '–æ–±'
];

/**
 * –ó–∞–º–µ–Ω—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã –ø–æ—Å–ª–µ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–ª–æ–≤ –Ω–∞ –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω—ã–µ
 * @param {HTMLElement} element - —ç–ª–µ–º–µ–Ω—Ç DOM –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
 */
function fixWidows(element) {
  element.innerHTML = element.innerHTML.replace(
    new RegExp(`\\b(${shortWords.join('|')})\\s+`, 'gi'),
    '$1&nbsp;'
  );
}

export class CompNoWidows extends HTMLElement {
  constructor() {
    super();
  }

  connectedCallback() {
    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ —Ü–µ–ª–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    document.querySelectorAll('p, li, span, h1, h2, h3, h4, h5, h6')
      .forEach(el => {
        if (!el.hasAttribute('data-no-widows')) {
          fixWidows(el);
        }
      });
  }
}

// –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
customElements.define('comp-no-widows', CompNoWidows);
  